# AI Parallel Ops

Claude Code、Google Gemini（画像生成: Nano Banana等）など複数のAIツールを並列稼働させ、監督（ディレクター）として仕事を進めるためのワークフロー定義。

## コンセプト

- 自分は手を動かさない。複数のAIツールに委任し、判断とレビューに集中する
- 複数タスクを同時進行する（例: 4並列）
- AIは自律的に動き、判断に迷った場合のみエスカレーションしてくる

## 私の役割: 監督（ディレクター）

- 自分で手を動かすのではなく、複数のAIツール/エージェントに仕事を委任する
- AIは自律的に動く。判断に迷いエスカレーションしてきた問題に対してのみ介入する
- 成果物のレビューと最終判断を行う
- 同時稼働数は状況に応じて拡張可能（例: 4並列）

## 日々の仕事の流れ（例: 4並列）

### 0. ゴール定義: 何を達成するか決める
- 今日/今回のセッションで達成したいゴールを明文化する
- ゴールが曖昧だとTODOがブレる。ここが全ての起点

```
例: 「プロダクト紹介のWebページとプレゼン資料を完成させる」
```

### 1. 成果物の定義: 何ができたら完了か
- 各タスクの完了条件を決める
- これがないとAIが止め時を判断できず、レビューの基準もない

```
例:
  - Webページ → index.html が動作しデプロイ可能な状態
  - シナリオ → Markdown形式、5章構成、各章300字以上
  - 画像素材 → 各シーン用に5枚、1024x1024、PNG
  - スライド → Markdown形式、15ページ構成
```

### 2. 共通ルールの整備
- トーン、命名規則、ディレクトリ構成など、全タスクに共通するルールを整理する
- CLAUDE.mdや共有ドキュメントに書いておけば、毎回指示に含める必要がない

### 3. TODO整理: 作業一覧を洗い出す
- ゴールと成果物の定義から、必要な作業を全て洗い出す
- この一覧が監督としての全体把握の地図になる
- 各AIへの指示が「TODO #3をやれ」で済むようになる

### 4. 依存関係の整理
並列度を最大化するために、TODOを2種類に分ける:

- **独立タスク**: 他の成果物を待たずに着手できる
- **依存タスク**: 先行タスクの成果物が必要

```
例:
  [独立] コード実装
  [独立] 画像素材生成
  [独立] シナリオ骨子作成
  [依存] スライド作成 ← シナリオ骨子 + 画像素材が必要
```

> **段取り（0〜4）が並列実行の効率を決める。段取り8割、実行2割。**

### 5. 一斉投入: 独立タスクを同時に全部起動する
独立タスクは待つ理由がない。一気に起動する。

1. ターミナル/ブラウザを必要数開く
2. **全ウィンドウに指示を貼り付けてから、順にEnterを押す**（1つ起動を見届けてから次、ではない）
3. 各タスクに渡すもの:
   - ゴールと成果物の定義
   - 参照すべきファイルパス
   - 制約条件（トーン、ルール等）
   - 「判断に迷ったら聞け。それ以外は自分で進めろ」
4. ツールの割り当て:
   - コード生成・シナリオ生成・スライド生成 → Claude Code
   - 画像生成 → Google Gemini (Nano Banana等)

### 6. 監督: 巡回しながらエスカレーション対応
- 全AIが同時に自律稼働している状態を維持する
- **巡回パターン**: 端末を定期的に切り替えて進捗を目視確認
- エスカレーション（質問）が来ていたら即判断して再開させる
- **スロットが空いたら即補充**: 1つ完了 or 待ちになったら、次のタスクを投入して並列数を維持する
- 質問が来ない＝順調。放置でいい

### 7. 依存タスクの即時投入
- 先行タスクが完了したら、その成果物のパスを渡して依存タスクを即起動
- 空いたスロットに詰め込み、常に並列数を埋める

```
時間軸 →
スロット1: [コード実装---------]  [次のタスク----]
スロット2: [画像素材生成---]  [スライド作成（依存解消）---]
スロット3: [シナリオ骨子---]  [別タスク--------]
スロット4: [調査タスク--]  [別タスク--]  [別タスク--]
```

## 稼働率を落とさないためのルール

並列の意味がなくなる最大の原因は「自分だけが動いていてAIが遊んでいる」状態。これを防ぐ。

### アンチパターン: こうなったら負け

| 状態 | 原因 | 対策 |
|------|------|------|
| 自分だけが作業している | AIへの指示作成に時間をかけすぎ | 指示テンプレートを事前に用意する。完璧な指示より早い投入 |
| 1〜2スロットしか埋まっていない | 投入するタスクが思いつかない | 段取りフェーズ（0〜4）でTODOを十分に洗い出しておく |
| AIが全員止まって待っている | エスカレーション対応が遅い | 巡回頻度を上げる。判断を即断する。迷ったら「とりあえずこれで進めろ」 |
| 完了したのにスロットが空いたまま | 次に何を投入すべきかわからない | TODOリストに優先順位をつけておく。次の投入候補を常に把握 |
| レビューに時間を取られてスロットが埋まらない | レビューと投入を直列にやっている | 先に次タスクを投入してからレビューする |

### 原則: 自分が手を止めるな、ではなく「AIを止めるな」

- **投入 > レビュー**: 成果物のレビューより、空きスロットへの投入を優先する
- **即断即決**: エスカレーションへの回答に悩むなら、仮の方針で進めさせて後で修正
- **指示は雑でいい**: 完璧な指示を練るより、70%の指示で早く投入し、途中で軌道修正
- **段取りで勝負をつける**: 実行フェーズで迷わないために、段取りフェーズでTODOと優先順位を固めておく

### 8. レビュー・承認
- 完了した成果物から順にレビューする
- 修正指示 → 同じスロットで再実行
- 承認 → スロットを解放して次のタスクへ

## 運用原則（経営・軍事・製造業の知見から）

### 指示の出し方: 意図を伝えよ、手順を伝えるな

**ミッションコマンド（独: Auftragstaktik / NATO軍事ドクトリン）** から。部下には「何を達成するか」と「なぜそれが必要か」を伝え、「どうやるか」は任せる。AIへの指示も同じ。

- 各タスクには **Commander's Intent（指揮官の意図）** を含める
- やるべきことだけでなく、**やってはいけないこと**の境界も明示する
- 詳細な手順指定は、AIが不慣れな領域のタスクに限定する

**タスク習熟度で指示の粒度を変える（Andy Grove『High Output Management』）:**

| AIの習熟度 | 指示の粒度 | 例 |
|-----------|-----------|-----|
| 高（定型作業） | ゴールだけ伝える | 「このAPIにCRUDエンドポイントを追加」 |
| 中 | ゴール＋制約＋参考ファイル | 「認証機能を追加。既存のauth.tsのパターンに合わせろ」 |
| 低（複雑・初見） | ゴール＋制約＋手順＋中間チェックポイント | 「まず設計案を出せ。承認後に実装に入れ」 |

### 監督のレバレッジ: 何に時間を使うかが全てを決める

**マネージャーのレバレッジ（Andy Grove『High Output Management』）** から。監督の生産性 ＝ 全AIの総出力 / 監督が使った時間。

- **最高レバレッジ**: 事前の指示設計。5分の明確な指示で、2時間のAI迷走を防ぐ
- **高レバレッジ**: 並列タスク間のインターフェース定義。ここだけは監督自身が決める
- **低レバレッジ**: 完了済み成果物の細かいレビュー → 後回しにしてスロット投入を優先

### ボトルネック理論: 自分が詰まりポイントだと自覚する

**制約理論（Goldratt『ザ・ゴール』）** から。システム全体のスループットはボトルネック1箇所で決まる。AIをいくら増やしても、監督の処理速度が上限になる。

- **ボトルネック（＝自分）を遊ばせるな**: 常に次の投入候補を手元に用意しておく
- **ボトルネックの前にバッファを置け**: 指示テンプレートを事前作成し、投入をゼロ秒で行える状態にする
- **ボトルネック以外の最適化は幻想**: AIの応答速度を気にするより、自分のレビュー・判断速度を上げる

### ラインを止めるな、ただし不良品は即止める

**トヨタ生産方式（アンドン・コード）** から。問題を検知したら即座にラインを止める。不良品が下流に流れるコストの方が大きい。

- **複雑なタスクは「計画 → 承認 → 実行」の2段階にする**: AIにまず計画だけ出させ、60秒で確認してから実行させる
- **間違った方向に30分走らせるより、即殺して再投入**: 途中修正より再起動の方が速い場合が多い
- **ただし順調なAIは絶対に止めるな**: 不必要な中間チェックは並列効率を殺す

### WIP制限: 並列数には自分の処理能力で上限がある

**カンバン / リーン生産方式** から。仕掛り（WIP）を増やしすぎるとスループットが落ちる（リトルの法則）。

- **自分がコンテキストを保持できる数が真の上限**: 端末を切り替えた時に「これ何だっけ」となったら超過
- **まず3並列から始めて、レビューに余裕があれば増やす**
- 目安: WIP上限 ＝ 自分のレビュー処理速度/時 × タスク平均所要時間

### 標準化: 指示テンプレートで投入速度を上げる

**トヨタ生産方式（標準作業）** から。全ての作業を標準化すれば、品質が安定し、問題が逸脱として即座に見える。

タスク投入テンプレート:
```
## 意図（なぜやるか）
[プロジェクト全体の目的と、このタスクの位置づけ]

## 目的（何を達成するか）
[1文で]

## 成果物と完了条件
[具体的、検証可能な条件]

## 制約（やってはいけないこと）
[境界の明示]

## 参照ファイル
[必要なパス一覧]

## エスカレーション基準
判断に迷ったら聞け。それ以外は自分で進めろ。
```

### ファイルスコープの分離: 同じファイルを触るなら直列にしろ

**アジャイルのストーリー分割** から。並列タスクは薄い縦割りスライスにする。

- **2つのAIが同じファイルを触る＝並列不可、直列にする**
- 並列化の鍵は **インターフェースの事前定義**: 監督がモジュール間の境界を決めれば、各AIは独立して動ける
- これが監督の最高レバレッジ活動

### 主攻（Schwerpunkt）: 全てのリソースを集中すべきポイントを決める

**ドイツ軍事ドクトリン** から。常に1つの主攻方向を定め、他は支援に回す。

- 並列タスクの中で1つを **主攻（クリティカルパス）** に指定する
- 主攻タスクのレビューを最優先。競合が起きたら主攻が勝つ
- 他のタスクは主攻を支援するか、主攻と干渉しない独立領域で動く

## 並列監督の具体的テクニック（現場の知恵から）

> 全ドメインに共通する核心: 誰も本当には「マルチタスク」していない。**構造化されたスキャン＋例外ベースの介入**で並列を維持している。広く監視し、狭く行動する。

### スキャン技法: 管制官のように巡回せよ

**航空管制（ATC）の3サイクルモデル** から。管制官は3つの認知ループを異なる頻度で回す:

1. **監視サイクル（15〜30秒ごと）**: 全端末をスキャン。問題を「解く」のではなく「気づく」だけ
2. **予測サイクル**: 監視で気になった点について、近い将来どうなるかを予測する
3. **解決サイクル**: 予測が問題を示した場合のみ、対処に入る

実践:
- **全端末を左から右へ、常に同じ順序でスキャン**する。順序を変えない
- スキャン中に問題を見つけても **その場で対処しない**。フラグだけ立ててスキャンを完了させる
- スキャン完了後、フラグを立てた端末に優先度順で対処する
- **「トンネリング」を絶対に避ける**: 1つのエージェントの問題に没頭して他が放置される状態。全ドメインでこれが最大のリスクとされている

### 優先度トリアージ: 救急のように仕分けよ

**ER（救急外来）のESIトリアージ** から。スキャン後に対処する順序:

| 優先度 | 状態 | 対応 |
|--------|------|------|
| P1 | エラーで停止。他のエージェントもブロックしている | 即座に対処 |
| P2 | タスク完了。次の指示待ち（スロットが遊んでいる） | 速やかに次タスクを投入 |
| P3 | 微妙に方向がずれている | 次の区切りで軌道修正 |
| P4 | 順調に稼働中 | 何もしない |

- **定期的に再トリアージする**: 10分前に順調だったエージェントが今は詰まっているかもしれない
- **順調なエージェントに触るな**: 不必要な介入は並列効率を殺す

### ホールド＆ファイア: 厨房のように投入タイミングを制御せよ

**レストランのエクスペディター（厨房の司令塔）** から。エクスペディターは20〜50皿を同時に管理する:

- **チケットレール**: タスクを時間順に並べる。各タスクの状態が一目でわかる
- **ホールド/ファイア**: タスクを即座に全投入するのではなく、前提条件が揃った瞬間に「ファイア」する
- **バックタイミング**: 成果物Aが完了するタイミングに合わせて、Aに依存するタスクBの投入を逆算する

実践:
- TODOリストの各タスクに「投入条件」を書いておく
- 条件が揃った瞬間にゼロ秒で投入できるよう、指示文を事前に用意しておく
- **自分の立ち位置はエクスペディターと同じ「パス（受け渡し口）」**: 全ての成果物が自分を通過する品質ゲート

### バトルリズム: 軍のように定期サイクルを回せ

**軍事作戦センター（TOC）のバトルリズム** から。バトルリズムは「スケジュール」ではなく「強制的な情報サイクル」:

**15分サイクル**（推奨）:
1. 全エージェントの状態を確認（スキャン）
2. 全体計画はまだ有効か？
3. 次に完了するエージェントはどれか？次の投入タスクは何か？
4. 状態ボードを更新する

- **FRAGOs（断片命令）で軌道修正**: 計画変更時は全部説明し直さない。「元の意図は変わらない。変更点: ○○。理由: ○○。現在の作業を続行せよ」
- **計画と実行を混ぜるな**: スキャン中に次の計画を練り始めない。15分サイクルの中で分離する

### 例外ベース監視: トレーディングフロアのように閾値で管理せよ

**トレーディングデスク** から。マネージャーは全トレードを見ない。閾値を超えた例外だけを見る:

- **閾値の設定例**:
  - エージェントの出力が2分以上止まった → 調査
  - エラーキーワードが出力に現れた → 即対応
  - タスク開始から想定時間を超過した → 確認
- **閾値を超えなければ何もしない**: 全てが緑なら介入不要
- **ダッシュボード**: tmuxの分割ペインで全エージェントの出力を同時に表示。読むのではなく、色と動きで状態を判断する

### 外部記憶: 管制官のようにストリップボードを使え

**ATCのフライト・プログレス・ストリップ** から。管制官は記憶に頼らない。物理的なカードを並べて状態を管理する:

全ドメインに共通: **認知負荷が高い状態で記憶に頼ると必ず抜け落ちる。外部に書き出せ。**

エージェント状態ボード（テキストファイル、付箋、何でもいい）:
```
| エージェント | 現在のタスク | 状態 | 次のタスク | 備考 |
|------------|------------|------|----------|------|
| 端末1      | API実装     | 🟢稼働中 | テスト作成 |      |
| 端末2      | 画像生成    | 🟡質問待ち | -        | 構図の確認待ち |
| 端末3      | シナリオ執筆 | 🟢稼働中 | スライド作成 |      |
| 端末4      | 調査タスク   | 🔴完了   | DB設計    | レビュー待ち |
```

- **スキャンのたびに更新する**
- 「これ何だっけ」と思ったらボードを見る。記憶を使わない
- 判断ログも残す: 「10:45 端末2に○○のアプローチで進めるよう指示。理由: ○○」

### セットアップ: 映画監督のように事前に段取れ

**映画撮影の1st AD（ファーストAD）方式** から。監督は部門を直接管理しない。段取りと意図の伝達が仕事:

- **コールシート（作業指示書）**: 開始前に各エージェントの計画を書面で用意する（段取りフェーズ0〜4）
- **意図の伝達**: 各部門（＝各エージェント）にはクリエイティブな意図を伝え、実行方法は任せる
- **介入は自然な区切りでのみ**: テイクの途中（＝タスク実行中）ではなく、テイク間（＝タスク完了時）に指示を出す
- **ラストルックス**: 各エージェントにタスクを最終投入する前に、全体の整合性を30秒で確認する

### スケールの原則: ICSのように3〜7の範囲を守れ

**インシデント・コマンド・システム（ICS / FEMA）** から。消防・災害対応で最も実証されたスパン・オブ・コントロール:

- **1人の監督者が管理できる直接報告は3〜7。最適は5**
- これを超えたら管理階層を追加する（＝オーケストレーター・エージェントを1つ置いて、それが他のエージェントを管理する構成）
- **まず3から始める。リズムが掴めたら増やす。リズムなき増員は混乱**
- **チェックイン/チェックアウト**: エージェント起動時に記録、終了時に何を完了したか記録。常に稼働状況を把握

### 研究知見: 自律エージェント監督の学術的裏付け

- **Chen & Barnes (2012)「Supervisory Control of Multiple Robots」**: エージェント数が増えると監督者の状況認識が崩壊する。自動化された意思決定支援なしでは4体以上の同時監督は困難
- **UAVオペレーター研究 (2007)**: 低負荷では手動監視で十分。高負荷（4+）では自動アラートが必須
- **タスクマネージャー研究 (Springer, 2015)**: 生の出力ではなく「タスク状態」で管理することで記憶負荷と中断コストが大幅に低下

## 並列の使い分け

| 状況 | 方式 |
|------|------|
| 別々のプロジェクト・別々の成果物 | 独立した別ウィンドウ/タブで別AIツールを起動 |
| 同一プロジェクト内の並列作業（Claude Code） | 1つのClaude内でサブエージェントを使う |

## AIツール間の連携

- ファイルシステム経由で行う
- Claude Aの成果物を Claude Bに参照させたい場合、ファイルパスを指示に含める
- 依存関係があるタスクは先行タスク完了後に投入する

## 作業ディレクトリの原則

- 各Claudeの作業ディレクトリは分ける（衝突防止）
- 共通ルールはCLAUDE.mdに書いておく（毎回指示不要にする）

## 参考文献

### 経営・マネジメント
- Andy Grove『High Output Management』— タスク習熟度、マネージャーのレバレッジ
- Peter Drucker『The Effective Executive』— 集中、貢献への焦点

### 製造・オペレーション
- Eliyahu Goldratt『ザ・ゴール』— 制約理論、ボトルネック管理
- トヨタ生産方式 — アンドン・コード、標準作業、カンバン、WIP制限

### 軍事
- NATO Mission Command / Auftragstaktik — 意図の伝達、自律行動
- ドイツ軍事ドクトリン — Schwerpunkt（主攻）、FRAGOs（断片命令）
- US Army ATP 6-0.5 "Command Post Organization and Operations" — バトルリズム、TOC運用

### 現場オペレーション
- 航空管制（ATC）— 3サイクルモデル、フライト・プログレス・ストリップ、構造化スキャン
- レストラン・エクスペディター — ホールド＆ファイア、チケットレール、バックタイミング
- ER（救急外来）— ESIトリアージ、動的再評価
- NASA Mission Control — 例外ベース監視、コンソール・ポジション、バックルーム
- ICS（インシデント・コマンド・システム）— スパン・オブ・コントロール、IAP、チェックイン/チェックアウト
- トレーディングフロア — 閾値アラート、ダッシュボード監視

### アジャイル
- スクラム / カンバン — ストーリー分割、Definition of Done、タイムボックス、WIP制限

### 学術研究
- Chen & Barnes (2012)「Supervisory Control of Multiple Robots」Human Factors 54(3)
- 「Operator Scheduling Strategies in Supervisory Control of Multiple UAVs」ScienceDirect (2007)
- 「Tasking Teams」Springer (2015) — タスクマネージャーインターフェースによる監督負荷低減
